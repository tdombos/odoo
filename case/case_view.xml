<?xml version="1.0"?>
<openerp>
    <data>
        <menuitem name="Services" id="menu_service" sequence="120" groups="base.group_system"/>
        <!-- Case Tree View -->
        
        <!-- Case Form View -->
        <record id="view_case_case_form" model="ir.ui.view">
            <field name="name">case.case.form</field>
            <field name="model">case.case</field>
            <field name="arch" type="xml">
                <form string="Case">
                <header>
                    <button name="do_open" string="Open" type="object" states="draft" groups="base.group_user" class="oe_highlight"/>
                    <button name="do_close" string="Close" type="object" states="open" groups="base.group_user" class="oe_highlight"/>
                    <field name="state" widget="statusbar" statusbar_visible="draft,open,close" statusbar_colors='{"pending":"blue"}' readonly="1"/>
                </header>
                <sheet string="Case">
                    <field name="analytic_account_id" invisible="1" required="0"/>
                    <field name="project_id" invisible="1" required="0" />
                    <field name="department_id" invisible="1" required="0" />
                    <div class="oe_title">
                        <label for="name" class="oe_edit_only" string="Name"/>
                        <h1>
                            <field name="name" string="Name"/>
                        </h1>
                        <div name="options_active">
                            <field name="use_tasks" class="oe_inline"/>
                            <label for="use_tasks" string="Use Tasks"/>
                        </div>
                    </div>
                    <div class="oe_right oe_button_box" name="buttons" groups="base.group_user">
                        <button class="oe_inline oe_stat_button" name="%(project_partner.action_project_partner_partnertoproject)d" type="action" icon="fa-users" context="{'default_project_id': project_id,'project_id': project_id,'search_default_active':1}" >
                            <field string="Partners" name="partner_count" widget="statinfo"/>
                        </button>
                        <button class="oe_inline oe_stat_button" type="action" icon="fa fa-phone" name="%(project_phonecalls.action_project_phonecall_calltoproject)d" context="{'default_project_id': project_id,'project_id': project_id}">
                            <field string="Calls" name="project_phonecall_count" widget="statinfo"/>
                        </button>
                        <button class="oe_inline oe_stat_button" type="action" icon="fa fa-calendar" name="%(project_meetings.action_project_meeting_eventtoproject)d" context="{'default_project_id': project_id,'project_id': project_id}">
                            <field string="Meetings" name="project_meeting_count" widget="statinfo"/>
                        </button>
                        <button class="oe_inline oe_stat_button" type="action" name="%(action_case_view_task)d" icon="fa-tasks" context="{'default_project_id': project_id,'project_id': project_id}" >
                            <field string="Tasks" name="task_count" widget="statinfo"/>
                        </button>
                        <button  class="oe_inline oe_stat_button" name="%(action_case_documenttocase)d" type="action" icon="fa-files-o" context="{'default_res_id': project_id, 'default_res_model': 'project.project', 'project_id': project_id}">
                            <field string="Documents" name="doc_count" widget="statinfo"/>
                        </button>
                    </div>
                    <group>
                            <field name="description" />
                    </group>   
                    <group>
                        <group>
                            <field name="user_id" string="Responsible"
                                    attrs="{'readonly':[('state','in',['close', 'cancelled'])]}"
                                    context="{'default_groups_ref': ['base.group_user', 'base.group_partner_manager', 'project.group_project_manager']}" required="1"/>
                            <field name="department_id"/>
                            <field name="partner_id" string="Client" required="1" />
                        </group>
                        <group>    
                            <field name="date_start" string="Case arrived on" required="1" />
                            <field name="date" string="Case closed on" states="closed" />
                        </group>
                    </group>
                    <notebook>
                        <page string="Content">
                            <group >
                                <field name="tag_ids" widget="many2many_tags" domain="[('department_id', '=', department_id)]" context="{'default_department_id': department_id}"/>
                                <field name="externalref" />
                                <field name="description_anon" />
                                <field name="servicelevel_ids" widget="many2many_checkboxes" domain="[('department_id', '=', department_id)]"/>
                            </group>
                        </page>
                        <page string="Demography">
                            <group >
                                <group>
                                    <field name="gender" />
                                    <field name="trans" />
                                    <field name="sexorient" />
                                </group>
                                <group>
                                    <field name="settlement" />
                                    <field name="age" />
                                    <field name="agecateg_id" />
                                    <field name="demogrtag_ids" widget="many2many_tags"/>
                                </group>
                            </group>
                        </page>
                        <page string="Other Info">
                            <group string="Administration">
                                <field name="privacy_visibility" widget="radio"/>
                                <field name="planned_hours" widget="float_time"
                                        groups="project.group_time_work_estimation_tasks"/>
                                <field name="effective_hours" widget="float_time"
                                        groups="project.group_time_work_estimation_tasks"/>
                                <field name="resource_calendar_id"
                                        groups="project.group_time_work_estimation_tasks"/>
                            </group>
                            <group string="Miscellaneous" name="misc">
                                <field name="sequence" groups="base.group_no_one"/>
                                <field name="active" attrs="{'invisible':[('state','in',['open', 'pending', 'template'])]}"/>
                                <field name="parent_id" string="Parent" help="Append this project to another one using analytic accounts hierarchy" domain="[('id','!=',analytic_account_id)]" context="{'current_model': 'project.project'}" />
                            </group>
                            <group name="group_alias" attrs="{'invisible': [('alias_domain', '=', False)]}">
                                <label for="alias_name" string="Email Alias"/>
                                <div name="alias_def">
                                    <field name="alias_id" class="oe_read_only oe_inline"
                                            string="Email Alias" required="0"/>
                                    <div class="oe_edit_only oe_inline" name="edit_alias" style="display: inline;" >
                                        <field name="alias_name" class="oe_inline"/>@<field name="alias_domain" class="oe_inline" readonly="1"/>
                                    </div>
                                </div>
                                <label for="alias_model" string="Incoming Emails create"/>
                                <field name="alias_model" class="oe_inline" nolabel="1"/>
                                <field name="alias_contact" class="oe_inline"
                                        string="Accept Emails From"/>
                            </group>
                        </page>
                    </notebook>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers" groups="base.group_user"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
                </form>
            </field>
        </record>
        
        <!-- Search Case  -->
        
        <record model="ir.ui.view" id="view_case_case_search">
            <field name="name">case.case.search</field>
            <field name="model">case.case</field>
            <field name="arch" type="xml">
                <search string="Cases">
                    <field name="name" string="Name" />
                    <field name="partner_id" string="Client" />
                    <field name="tag_ids" string="Tags"/>
                    <filter name="draft" string="Incoming" domain="[('state','=', 'draft')]" help="Cases waiting to be dealt with" />
                    <filter name="open" string="Open" domain="[('state','=', 'open')]" help="Cases currently dealt with" />
                    <filter name="mydoc" string="My documents" domain="[('user_id','=',uid)]" help="Cases assigned to me" />
                    <group expand="0" string="Group by...">
                        <filter string="State" help="By State" context="{'group_by':'state'}" />
                    </group>
                </search>
            </field>
        </record>
        
        <!-- Case Tree  -->
        
        <record model="ir.ui.view" id="view_case_case_tree">
            <field name="name">case.case.tree</field>
            <field name="model">case.case</field>
            <field name="field_parent"></field>
            <field name="arch" type="xml">
                <tree string="Cases">
                    <field name="name" string="Code"/>
                    <field name="state"/>
                </tree>
            </field>
        </record>
        
        <!-- Document Tree  -->
        
        <record model="ir.ui.view" id="view_case_document_tree">
            <field name="name">case.document.tree</field>
            <field name="model">case.document</field>
            <field name="priority" eval="1"/>
            <field name="arch" type="xml">
                <tree string="Documents">
                    <field name="name"/>
                    <field name="date" />
                    <field name="date_done"/>
                    <field name="partner_id"/>
                    <field name="doctype_id"/>
                </tree>
            </field>
        </record>
        
        <!-- Document Form  -->
        
        <record model="ir.ui.view" id="view_case_document_form">
            <field name="name">case.document.form</field>
            <field name="model">case.document</field>
            <field name="priority" eval="1"/>
            <field name="arch" type="xml">
                <form string="Document">
                   <sheet>
                    <label for="name" class="oe_edit_only"/>
                    <h1>
                        <field name="name"/>
                    </h1>
                    <group>
                        <group >
                            <field name="direction" />
                            <field name="doctype_id" />
                            <field name="partner_id" />
                            <field name="res_id" />
                            <field name="res_name" />
                            <field name="res_model" />
                        </group>
                        <group >
                            <field name="date"/>
                            <field name="date_done"/>
                            <field name="channel_id" />
                        </group>
                    </group>
                    <group >
                            <field name="type"/>
                            <field name="datas" filename="datas_fname" attrs="{'invisible':[('type','=','url')]}"/>
                            <field name="datas_fname" invisible="1" attrs="{'invisible':[('type','=','url')]}" class="oe_inline oe_right"/>
                            <field name="url" widget="url" attrs="{'invisible':[('type','=','binary')]}"/>
                    </group>
                    <field name="description" placeholder="Add extra information..."/>
                  </sheet>
                </form>
            </field>
        </record>
        
        <!-- Code to Department Form-->
        
        <record id="view_case_departmentmod_form" model="ir.ui.view">
            <field name="name">Code to department form</field>
            <field name="model">hr.department</field>
            <field name="inherit_id" ref="hr.view_department_form"/>
            <field name="arch" type="xml">
                <field name="name" position="after" >
                    <field name="code" />
                </field>
            </field>
        </record>
             
        <!-- Actions-->     
         
        <record model="ir.actions.act_window" id="action_case_case">
            <field name="name">Cases</field>
            <field name="res_model">case.case</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="search_view_id" ref="view_case_case_search"/>
        </record>
        <record model="ir.actions.act_window" id="action_case_servicelevel">
            <field name="name">Service levels</field>
            <field name="res_model">case.servicelevel</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
        </record>
        <record model="ir.actions.act_window" id="action_case_tag">
            <field name="name">Tags</field>
            <field name="res_model">case.tag</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
        </record>
        <record model="ir.actions.act_window" id="action_case_demogrtag">
            <field name="name">Demography Tags</field>
            <field name="res_model">case.demogrtag</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
        </record>
        <record model="ir.actions.act_window" id="action_case_agecateg">
            <field name="name">Age Categories</field>
            <field name="res_model">case.agecateg</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
        </record>
        <record model="ir.actions.act_window" id="action_case_doctype">
            <field name="name">Document Types</field>
            <field name="res_model">case.doctype</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
        </record>
        <record model="ir.actions.act_window" id="action_case_partnertocase">
            <field name="name">Partners</field>
            <field name="res_model">project_partner.partnerline</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree</field>
            <field name="domain">[('project_id','=',[project_id])]</field>
        </record>
        <record model="ir.actions.act_window" id="action_case_documenttocase">
            <field name="name">Documents</field>
            <field name="res_model">case.document</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('res_id','=',[project_id])]</field>
        </record>
        <record model="ir.actions.act_window" id="action_case_document_tree">
            <field name="name">Documents</field>
            <field name="res_model">case.document</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
        </record>
        <record id="action_case_view_task" model="ir.actions.act_window">
            <field name="name">Tasks</field>
            <field name="res_model">project.task</field>
            <field name="view_mode">kanban,tree,form</field>
            <field name="search_view_id" ref="project.view_task_search_form"/>
            <field name="domain">[('project_id','=',[project_id])]</field>
            <field name="help" type="html">
                <p>
                    Odoo's project management allows you to manage the pipeline
                    of tasks in order to get things done efficiently. You can
                    track progress, discuss on tasks, attach documents, etc.
                </p>
            </field>
        </record>
        
        <!-- Menus-->  
        
        <menuitem name="Services" parent="menu_service" id="menu_service_service" sequence="1"/>
        <menuitem name="Configuration" parent="menu_service" id="menu_service_configuration" sequence="1"/>
        <menuitem name="Tags" parent="menu_service_configuration" id="menu_service_configuration_tags" sequence="1" action="action_case_tag"/>
        <menuitem name="Service Levels" parent="menu_service_configuration" id="menu_service_configuration_servicelevels" sequence="2" action="action_case_servicelevel"/>
        <menuitem name="Demography Tags" parent="menu_service_configuration" id="menu_service_configuration_demogrtags" sequence="3" action="action_case_demogrtag"/>
        <menuitem name="Age Categories" parent="menu_service_configuration" id="menu_service_configuration_agecategs" sequence="3" action="action_case_agecateg"/>
        <menuitem name="Document Types" parent="menu_service_configuration" id="menu_service_configuration_doctypes" sequence="3" action="action_case_doctype"/>
        <menuitem name="Cases" parent="menu_service_service" id="menu_service_case" action="action_case_case" />
        <menuitem name="Documents" parent="menu_service_service" id="menu_service_document" action="action_case_document_tree" />
   </data>
</openerp>
